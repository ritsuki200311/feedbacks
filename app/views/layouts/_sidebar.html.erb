<!-- „Çµ„Ç§„Éâ„Éê„Éº -->
<div id="sidebar">
  <h2 class="text-2xl font-bold mb-6 text-gray-700">Feedbacks</h2>
  <nav class="flex flex-col space-y-2">
    <!-- „Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóË°®Á§∫Áî®„ÅÆÂÖ®„É°„Éã„É•„ÉºÔºàmd‰ª•‰∏ä„ÅßË°®Á§∫Ôºâ -->
    <div class="hidden md:flex md:flex-col md:space-y-2">
      <%= link_to "„Éõ„Éº„É†", root_path, class: sidebar_link_class(root_path) %>
      <%= link_to "Ê§úÁ¥¢", search_path, class: sidebar_link_class(search_path) %>
      <%= link_to rooms_path, class: "#{sidebar_link_class(rooms_path)} flex items-center justify-between" do %>
        <span>„ÉÄ„Ç§„É¨„ÇØ„Éà„É°„ÉÉ„Çª„Éº„Ç∏</span>
        <% if user_signed_in? && current_user.unread_messages_count > 0 %>
          <span class="bg-red-500 text-white text-xs rounded-full h-6 w-6 flex items-center justify-center font-bold ml-2">
            <%= current_user.unread_messages_count > 9 ? "9+" : current_user.unread_messages_count %>
          </span>
        <% end %>
      <% end %>
      <%= link_to "Êñ∞Ë¶èÊäïÁ®ø", new_post_path, class: sidebar_link_class(new_post_path) %>
      <hr class="my-2">
      <% if user_signed_in? %>
        <%= link_to "„Éû„Ç§„Éö„Éº„Ç∏", mypage_path, class: sidebar_link_class(mypage_path) %>
        <%= link_to "„Ç≥„Éü„É•„Éã„ÉÜ„Ç£", communities_path, class: sidebar_link_class(communities_path) %>
        <%= link_to "„Ç¢„Ç´„Ç¶„É≥„ÉàÁ∑®ÈõÜ", edit_user_registration_path, class: sidebar_link_class(edit_user_registration_path) %>
        <%= link_to "Â•Ω„Åø„ÇíÁôªÈå≤", new_preference_path, class: sidebar_link_class(new_preference_path) %>
        <%= link_to "„É¶„Éº„Ç∂„ÉºÈñ¢‰øÇÊÄß", user_relationships_path, class: sidebar_link_class(user_relationships_path) %>
        <%= link_to "‰ΩúÂìÅ„Éû„ÉÉ„Éó", posts_map_path, class: sidebar_link_class(posts_map_path) %>
        <%= link_to "„Éó„É≠„Éï„Ç£„Éº„É´ÁôªÈå≤", new_supporter_profile_path, class: sidebar_link_class(new_supporter_profile_path) %>
        
        <!-- „Ç∞„É≠„Éº„Éê„É´„Ç≥„É°„É≥„Éà„Éî„É≥Ë°®Á§∫Âàá„ÇäÊõø„Åà -->
        <div class="px-4 py-2" data-controller="global-comment-pins">
          <button type="button" 
                  data-action="click->global-comment-pins#toggleGlobalPins"
                  data-global-comment-pins-target="toggleButton"
                  class="flex items-center gap-2 w-full text-left text-sm border border-gray-300 rounded px-3 py-2 hover:bg-gray-50 transition-colors">
            <span data-global-comment-pins-target="toggleIcon">üëÅÔ∏è</span>
            <span data-global-comment-pins-target="toggleText">„Ç≥„É°„É≥„Éà„Éî„É≥‰∏ÄÊã¨Ë°®Á§∫</span>
          </button>
        </div>
        
        <%= link_to "„É≠„Ç∞„Ç¢„Ç¶„Éà", destroy_user_session_path, method: :delete, class: "block text-left w-full text-red-500 hover:bg-red-50 px-4 py-2 rounded", data: { turbo_method: :delete, turbo_confirm: "„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü" } %>
      <% else %>
        <%= link_to "„É≠„Ç∞„Ç§„É≥", new_user_session_path, class: sidebar_link_class(new_user_session_path) %>
        <%= link_to "Êñ∞Ë¶èÁôªÈå≤", new_user_registration_path, class: sidebar_link_class(new_user_registration_path) %>
      <% end %>

    </div>

    <!-- „É¢„Éê„Ç§„É´Ë°®Á§∫Áî®„ÅÆ‰∫åÊ¨°„É°„Éã„É•„ÉºÔºàmd„Çà„ÇäÂ∞è„Åï„ÅÑÁîªÈù¢„ÅßË°®Á§∫Ôºâ -->
    <div class="md:hidden flex flex-col space-y-2">
      <% if user_signed_in? %>
        <%= link_to "„Ç¢„Ç´„Ç¶„É≥„ÉàÁ∑®ÈõÜ", edit_user_registration_path, class: sidebar_link_class(edit_user_registration_path) %>
        <%= link_to "Â•Ω„Åø„ÇíÁôªÈå≤", new_preference_path, class: sidebar_link_class(new_preference_path) %>
        <%= link_to "„É¶„Éº„Ç∂„ÉºÈñ¢‰øÇÊÄß", user_relationships_path, class: sidebar_link_class(user_relationships_path) %>
        <%= link_to "‰ΩúÂìÅ„Éû„ÉÉ„Éó", posts_map_path, class: sidebar_link_class(posts_map_path) %>
        <%= link_to "„Éó„É≠„Éï„Ç£„Éº„É´ÁôªÈå≤", new_supporter_profile_path, class: sidebar_link_class(new_supporter_profile_path) %>
        
        <!-- „Ç∞„É≠„Éº„Éê„É´„Ç≥„É°„É≥„Éà„Éî„É≥Ë°®Á§∫Âàá„ÇäÊõø„Åà -->
        <div class="px-4 py-2" data-controller="global-comment-pins">
          <button type="button" 
                  data-action="click->global-comment-pins#toggleGlobalPins"
                  data-global-comment-pins-target="toggleButton"
                  class="flex items-center gap-2 w-full text-left text-sm border border-gray-300 rounded px-3 py-2 hover:bg-gray-50 transition-colors">
            <span data-global-comment-pins-target="toggleIcon">üëÅÔ∏è</span>
            <span data-global-comment-pins-target="toggleText">„Ç≥„É°„É≥„Éà„Éî„É≥‰∏ÄÊã¨Ë°®Á§∫</span>
          </button>
        </div>
        
        <%= link_to "„É≠„Ç∞„Ç¢„Ç¶„Éà", destroy_user_session_path, method: :delete, class: "block text-left w-full text-red-500 hover:bg-red-50 px-4 py-2 rounded", data: { turbo_method: :delete, turbo_confirm: "„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü" } %>
      <% else %>
        <%= link_to "„É≠„Ç∞„Ç§„É≥", new_user_session_path, class: sidebar_link_class(new_user_session_path) %>
        <%= link_to "Êñ∞Ë¶èÁôªÈå≤", new_user_registration_path, class: sidebar_link_class(new_user_registration_path) %>
      <% end %>
    </div>
  </nav>
</div>
